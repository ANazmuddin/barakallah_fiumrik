<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HBD! üéâüéÄ</title>
  <meta name="description" content="Landing card ucapan ulang tahun kawaii untuk remaja. Foto & musik fixed. Autoplay + animasi selama musik diputar. Responsif." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --p1:#FFD6E7; --p2:#E6F6FF; --p3:#FFF7C7; --p4:#EAF8F1;
      --txt:#3a3a47; --stroke: rgba(0,0,0,.06); --card:#ffffffee;
      --accent:#FF79B0; --accent-2:#7AD7F0; --accent-3:#FFD166; --accent-4:#B8F5C7;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--txt);
      font-family:Fredoka, Nunito, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 500px at 10% 0%, var(--p1), transparent 60%),
        radial-gradient(900px 500px at 90% 20%, var(--p2), transparent 60%),
        radial-gradient(900px 500px at 20% 100%, var(--p3), transparent 60%),
        radial-gradient(900px 500px at 80% 90%, var(--p4), transparent 60%),
        linear-gradient(180deg,#fff,#fff);
      background-attachment: fixed;
      overflow-x:hidden;
    }

    .wrap{min-height:100%; display:grid; place-items:center; padding:clamp(16px,3vw,32px)}

    .card{
      width:min(880px,100%);
      background:var(--card);
      border:2px solid var(--stroke);
      border-radius:28px; box-shadow: 0 18px 50px rgba(88,88,120,.15), 0 2px 0 rgba(0,0,0,.05) inset;
      padding:clamp(18px,3vw,28px);
      position:relative; overflow:hidden;
    }

    /* BALON animasi latar */
    .balloon{position:absolute; width:110px; aspect-ratio:1/1.2; border-radius:50% 50% 48% 52%/60% 60% 40% 40%; opacity:.28; filter:blur(.4px)}
    .balloon.b1{background:var(--accent); left:-30px; bottom:-20px; animation:floatY 8s ease-in-out infinite}
    .balloon.b2{background:var(--accent-2); right:-40px; top:-20px; animation:floatY 10s ease-in-out infinite reverse}
    .balloon.b3{background:var(--accent-3); left:20%; top:-30px; width:90px; animation:floatY 9s ease-in-out infinite}
    @keyframes floatY{0%,100%{transform:translateY(0)}50%{transform:translateY(-16px)}}

    .sticker{position:absolute; pointer-events:none; opacity:.9; filter: drop-shadow(0 2px 0 rgba(0,0,0,.08));}
    .sticker.star{top:-14px; right:28px; transform:rotate(10deg)}
    .sticker.heart{bottom:-10px; left:22px; transform:rotate(-12deg)}

    .grid{display:grid; grid-template-columns:1fr; gap:18px; align-items:center}
    @media(min-width:820px){ .grid{ grid-template-columns: 330px 1fr } }

    .photo{position:relative; aspect-ratio:1/1; border-radius:24px; overflow:hidden; border:3px dashed #FFC3DB; background:#fff}
    .photo img{width:100%; height:100%; object-fit:cover; display:block}
    .photo .tape{position:absolute; width:120px; height:34px; left:12px; top:10px; background:linear-gradient(90deg,#FFEEFA,#E3F6FF); transform:rotate(-8deg); border-radius:8px; opacity:.9; border:1px solid var(--stroke)}

    .badge{display:inline-flex; align-items:center; gap:8px; font-size:1rem; padding:8px 12px; border-radius:999px; background:#fff; border:2px solid #FFE3F0; color:#D93F87; box-shadow:0 6px 0 #ffd3e6}

    h1{margin:.3rem 0 0; font-size:clamp(32px,5.2vw,54px); line-height:1.05; color:#22212b}
    .subtitle{margin:.25rem 0 0; color:#5f6075}

    .message{margin-top:12px; font-size:clamp(1rem,2.2vw,1.12rem); line-height:1.9; background:#fff; border:2px solid #D9F3FF; border-radius:18px; padding:14px 16px; box-shadow:0 8px 0 #BEEBFF}

    .controls{display:flex; gap:10px; margin-top:12px; flex-wrap:wrap}
    .btn{display:inline-flex; align-items:center; gap:8px; border:2px solid #FFE3F0; background:linear-gradient(180deg,#fff,#FFF5FB); padding:10px 16px; border-radius:14px; color:#D93F87; font-weight:700; cursor:pointer; box-shadow:0 8px 0 #FFD1E8; transition: transform .08s ease}
    .btn:active{transform:translateY(2px); box-shadow:0 4px 0 #FFD1E8}

    .audio{display:flex; gap:12px; align-items:center; background:#fff; border:2px solid #D9F3FF; border-radius:14px; padding:10px 12px; margin-top:12px; box-shadow:0 8px 0 #BEEBFF}
    .play{width:46px; height:46px; border-radius:50%; border:2px solid #FFDFF0; background:radial-gradient(circle at 30% 30%, #FF9AC3, #FF79B0); color:#fff; font-weight:900; cursor:pointer}
    .barz{display:flex; gap:4px; align-items:flex-end; height:24px}
    .bar{width:5px; height:6px; background:#A3DBF4; border-radius:3px; transform-origin:bottom}

    /* STATE: saat musik bermain, aktifkan animasi global */
    body.playing .badge{animation:wobble 1.8s ease-in-out infinite}
    body.playing .photo{animation:bob 2.4s ease-in-out infinite}
    body.playing .tape{animation:tapeWiggle 2.2s ease-in-out infinite}
    body.playing .balloon{animation-duration:6.5s}

    /* IDLE: animasi ringan saat musik belum aktif */
    body.idle .badge{animation:wobble 3.2s ease-in-out infinite}
    body.idle .photo{animation:bob 4s ease-in-out infinite}

    .audio[data-playing="true"] .bar:nth-child(1){animation:beat .6s ease-in-out infinite}
    .audio[data-playing="true"] .bar:nth-child(2){animation:beat .48s ease-in-out infinite}
    .audio[data-playing="true"] .bar:nth-child(3){animation:beat .72s ease-in-out infinite}
    .audio[data-playing="true"] .bar:nth-child(4){animation:beat .56s ease-in-out infinite}

    @keyframes beat{0%,100%{height:6px} 50%{height:24px}}
    @keyframes wobble{0%,100%{transform:rotate(0)}25%{transform:rotate(-3deg)}75%{transform:rotate(3deg)}}
    @keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    @keyframes tapeWiggle{0%,100%{transform:rotate(-8deg)}50%{transform:rotate(-4deg)}}

    .footer{display:flex; justify-content:space-between; gap:12px; align-items:center; flex-wrap:wrap; color:#6c6d82; font-size:.95rem; margin-top:14px}

    #confetti{position:fixed; inset:0; pointer-events:none; z-index:2}

    /* toast untuk enable sound saat autoplay diblokir */
    .toast{position:fixed; left:50%; bottom:20px; transform:translateX(-50%); background:#222; color:#fff; padding:10px 14px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.25); font-family:Nunito,system-ui; font-weight:700; opacity:0; pointer-events:none}
    .toast.show{opacity:1}
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="toast" id="toast">Click foto nya! üéµ</div>
  <main class="wrap">
    <section class="card" aria-label="Landing Card Ucapan Ulang Tahun">
      <!-- dekor balon -->
      <div class="balloon b1"></div>
      <div class="balloon b2"></div>
      <div class="balloon b3"></div>
      <!-- stiker -->
      <svg class="sticker star" width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M60 10l15 28 31 6-22 22 5 32-29-14-29 14 5-32L14 44l31-6 15-28z" fill="#FFE07F" stroke="#FFCA2E" stroke-width="3"/>
      </svg>
      <svg class="sticker heart" width="130" height="130" viewBox="0 0 130 130" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M65 110s-40-22-48-48c-6-19 7-36 24-36 13 0 20 7 24 14 4-7 11-14 24-14 17 0 30 17 24 36-8 26-48 48-48 48z" fill="#FFC3DB" stroke="#FF8BB7" stroke-width="3"/>
      </svg>

      <div class="grid">
        <!-- FOTO: ganti path sesuai file kamu -->
        <div class="photo">
          <span class="tape" aria-hidden="true"></span>
          <img src="assets/foto1.jpg" alt="Foto ulang tahun yang lucu">
        </div>
        <div>
          <span class="badge">üéÄ Barakallah Fiumrik</span>
          <h1>Untuk <span style="color:#FF69B4">Neng Hanum</span> üéâ</h1>
          <p class="subtitle">Barakallahu fii umrik, adekku yang aku sayang. ‚ú®</p>
          <div class="message">
            Semoga setiap tahun yang datang jadi jalan buat kamu jadi pribadi yang lebih baik, lebih dekat sama Allah, dan makin banyak kebaikan yang bisa kamu tebarkan. Semoga apa pun yang kamu cita-citakan dimudahkan jalannya, dan semoga kamu selalu diberi kesehatan, kebahagiaan, serta keberkahan hidup. üíñ
          </div>

          <!-- MUSIK: fixed source + autoplay -->
          <div class="audio" id="audioWrap" data-playing="false">
            <button class="play" id="playBtn" aria-label="Putar/Jeda">‚è∏</button>
            <audio id="player" src="assets/music.mp3" preload="auto" autoplay playsinline></audio>
            <div class="barz" aria-hidden="true"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
            <small style="margin-left:auto; opacity:.9">üéµ</small>
          </div>

          <div class="controls">
            <button class="btn" id="celebrateBtn">üéâ</button>
            <button class="btn" id="sparkBtn">‚ú®</button>
          </div>
        </div>
      </div>

      <div class="footer">
        <span id="statusText"></span>
        <span>dari a nazmu</span>
      </div>
    </section>
  </main>

  <script>
    // ---- Audio & autoplay handling ----
    const player = document.getElementById('player');
    const playBtn = document.getElementById('playBtn');
    const audioWrap = document.getElementById('audioWrap');
    const statusText = document.getElementById('statusText');
    const toast = document.getElementById('toast');
    let playing = false;

    async function tryAutoplay(){
      try{
        await player.play();
        onPlay();
      }catch(err){
        // Coba autoplay muted
        try{
          player.muted = true;
          await player.play();
          onPlay(true);
          toast.classList.add('show');
          const onFirst = ()=>{ player.muted=false; toast.classList.remove('show'); window.removeEventListener('pointerdown', onFirst, {once:true}); status('Suara aktif. Selamat menikmati!'); };
          window.addEventListener('pointerdown', onFirst, {once:true});
        }catch(e){
          toast.classList.add('show');
          const onFirst = async ()=>{ try{ await player.play(); onPlay(); toast.classList.remove('show'); }catch{} };
          window.addEventListener('pointerdown', onFirst, {once:true});
        }
      }
    }

    function onPlay(isMuted=false){
      playing = true; playBtn.textContent='‚è∏'; audioWrap.dataset.playing='true'; document.body.classList.remove('idle'); document.body.classList.add('playing'); status(isMuted ? 'Musik diputar (senyap). Tap untuk aktifkan suara.' : 'Musik diputar.');
    }
    function onPause(){ playing=false; playBtn.textContent='‚ñ∂'; audioWrap.dataset.playing='false'; document.body.classList.remove('playing'); document.body.classList.add('idle'); status('Musik dijeda.'); }

    playBtn.addEventListener('click', async ()=>{
      try{
        if(!playing){ await player.play(); onPlay(); }
        else{ player.pause(); onPause(); }
      }catch{ status('Tap sekali pada layar lalu coba lagi.'); }
    });
    player.addEventListener('ended', ()=>{ onPause(); });

    // Autoplay saat load + state idle
    document.addEventListener('DOMContentLoaded', ()=>{ document.body.classList.add('idle'); tryAutoplay(); });

    // ---- Confetti + Sparkle ----
    const c = document.getElementById('confetti');
    const ctx = c.getContext('2d');
    let pieces = [];
    function resize(){ c.width = innerWidth; c.height = innerHeight } window.addEventListener('resize', resize); resize();

    const COLORS = ['#FF79B0','#FFD166','#7AD7F0','#B8F5C7','#FFC3DB'];
    function spawnConfetti(n=150){ for(let i=0;i<n;i++){ pieces.push({ type: Math.random()<.6 ? 'rect':'heart', x:Math.random()*c.width, y:-20, s:6+Math.random()*10, c:COLORS[(Math.random()*COLORS.length)|0], a:Math.random()*Math.PI*2, vy:2+Math.random()*3, vx:-2+Math.random()*4, spin:-0.2+Math.random()*0.4, life:0}); } }
    function spawnSparkles(n=80){ for(let i=0;i<n;i++){ pieces.push({ type:'star', x:Math.random()*c.width, y:Math.random()*c.height*0.7, s:4+Math.random()*6, c:COLORS[(Math.random()*COLORS.length)|0], a:0, vy:-.2+Math.random()*.4, vx:-.2+Math.random()*.4, spin:.2, life:0}); } }

    function heartPath(ctx,s){ ctx.beginPath(); const k=s/12; ctx.moveTo(0,-k*1); ctx.bezierCurveTo(k*6,-k*6,k*12,k*3,0,k*10); ctx.bezierCurveTo(-k*12,k*3,-k*6,-k*6,0,-k*1); ctx.closePath(); }
    function starPath(ctx,s){ ctx.beginPath(); const spikes=5, outer=s/2, inner=s/4; let rot=Math.PI/2*3, x=0, y=0, step=Math.PI/spikes; ctx.moveTo(0,-outer); for(let i=0;i<spikes;i++){ x=Math.cos(rot)*outer; y=Math.sin(rot)*outer; ctx.lineTo(x,y); rot+=step; x=Math.cos(rot)*inner; y=Math.sin(rot)*inner; ctx.lineTo(x,y); rot+=step; } ctx.lineTo(0,-outer); ctx.closePath(); }

    // Emit sparkles ringan terus-menerus; lebih sering saat playing
    let ticker = 0;
    (function loop(){
      ctx.clearRect(0,0,c.width,c.height);
      pieces.forEach(p=>{ p.a+=p.spin*0.05; p.x+=p.vx; p.y+=p.vy; p.life+=1; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.a); ctx.fillStyle=p.c; if(p.type==='rect'){ ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s); } else if(p.type==='heart'){ heartPath(ctx,p.s); ctx.fill(); } else { starPath(ctx,p.s); ctx.fill(); } ctx.restore(); });
      pieces = pieces.filter(p=> p.y < c.height+40 && p.x>-40 && p.x<c.width+40 && p.life<800);
      ticker++;
      if(playing){ if(ticker%20===0) spawnSparkles(10); }
      else{ if(ticker%90===0) spawnSparkles(6); }
      requestAnimationFrame(loop);
    })();

    document.getElementById('celebrateBtn').addEventListener('click', ()=>{ spawnConfetti(180); });
    document.getElementById('sparkBtn').addEventListener('click', ()=>{ spawnSparkles(100); });
    // konfeti awal
    spawnConfetti(120);

    function status(text){ statusText.textContent=text; clearTimeout(status._t); status._t=setTimeout(()=>statusText.textContent='',3000); }
  </script>
</body>
</html>
